AcctSeed.ASModule=function(c,s){"use strict";function a(e,t){return new Promise(function(a,o){Visualforce.remoting.Manager.invokeAction(s.processAssociationAction,e,s.bankDepositId,t,function(e,t){t.status?a(e):o(t)},{timeout:12e4,buffer:!1})})}function o(){return new Promise(function(a,o){Visualforce.remoting.Manager.invokeAction(s.getTotalAssociation,s.bankDepositId,function(e,t){t.status?a(e):o(t)},{timeout:12e4,buffer:!1})})}function r(e,t){for(var a=0,o=e.length,n=[],a=0;a<o;a+=t){var r=e.slice(a,a+t);n.push(r)}return n}var i,d,t,n,l=s.currencyFormatterProxy,u=void 0!==s.currencyIsoCode?s.currencyIsoCode:"USD",h=!1,m=s.packageQualifier,g=void 0!==s.isMultiCurrencyEnabled&&"true"==s.isMultiCurrencyEnabled,f=(s.selectOrDeselectAll=function(e,t){c("."+t).each(function(){c(this).prop("checked",c('[id="'+e+'"]').prop("checked"))})},s.setSelectAllUnchecked=function(e){c('[id="'+e+'"]').prop("checked",!1)},s.getAssociatedRecords=function(){Visualforce.remoting.Manager.invokeAction(s.getAssociatedRecordsAction,s.bankDepositId,u,s.bankLedgerId,function(e,t){t.status?void 0!==e&&0<e.length?(function(e){void 0!==i&&i.clear(),i=c("#associatedTable").DataTable({data:e,lengthMenu:[[10,25,50,100,500],[10,25,50,100,500]],pageLength:100,columns:[{title:'<input id="associatedCheckboxHeader" type="checkbox"/>',data:"selected"},{title:"Name",data:"sourceObj"},{title:"Customer Name",data:"customerName"},{title:"Record Date",data:"objDate"},{title:"Amount",data:"money"},{title:"Ledger Amount",data:"money"},{title:"Reference",data:"reference"},{title:"Source",data:"sourceObj"}],columnDefs:[{searchable:!1,orderable:!1,targets:0,render:function(e,t,a,o){return'<input class="associatedCheckbox" onchange="AcctSeed.ASModule.checkSelectedAssociateLimit()" type="checkbox"/>'}},{targets:1,render:function(e,t,a,o){return'<a target="_blank" href="'+e.baseURL+"/"+e.sourceId+'">'+e.sourceName+"</a>"}},{targets:4,createdCell:function(e,t,a,o,n){t.recordAmount<0&&c(e).addClass("negativeAmount")},render:function(e,t,a,o){return"sort"===t||"type"===t?e.recordAmount:l(e.recordAmount,2,!1,e.recordCurrency)},className:"align-right"},{targets:5,visible:g,createdCell:function(e,t,a,o,n){t.ledgerAmount<0&&c(e).addClass("negativeAmount")},render:function(e,t,a,o){return"sort"===t||"type"===t?e.ledgerAmount:l(e.ledgerAmount,2,!1,e.ledgerCurrency)},className:"align-right"},{orderable:!1,targets:6},{targets:7,render:function(e,t,a,o){return'<a target="_blank" href="'+e.baseURL+"/"+e.sourceId+'">'+e.sourceType+"</a>"}}],order:[[3,"asc"]]}),c("#associatedCheckboxHeader").on("change",function(){s.selectOrDeselectAll(this.id,"associatedCheckbox"),s.checkSelectedAssociateLimit()}),c(".associatedCheckbox").each(function(){c(this).on("change",function(){s.setSelectAllUnchecked("associatedCheckboxHeader")})})}(e),c("#associatedMRDate").html(i.column(3).data()[0]),c("#associatedLRDate").html(i.column(3).data()[i.column(3).data().length-1]),c('[id$="leastRecentRecordDateLabel"]').show(),c('[id$="mostRecentRecordDateLabel"]').show(),c('[id$="zeroAssociatedResults"]').hide(),c('[id$=":unAssociateButton"]').show()):(c('[id$="leastRecentRecordDateLabel"]').hide(),c("#associatedLRDate").html(""),c('[id$="mostRecentRecordDateLabel"]').hide(),c("#associatedMRDate").html(""),c('[id$="zeroAssociatedResults"]').show(),c('[id$=":unAssociateButton"]').hide()):(t.type,c('[id$="errorPanel"]').show(),c('[id$="errorPanel"]').find("h4").html("Error: "+t.message),c('[id$="dataTablePanel"]').hide())},{escape:!1,timeout:12e4})},s.getUnassociatedRecords=function(){s.showOrHideDataPanel(!1);var e=c('[id$="unassociatedType"]').val(),t=c('[id$="startDate"]').val(),a=c('[id$="endDate"]').val(),o=void 0!==c('[id$="glavVar1"]').val()?c('[id$="glavVar1"]').val():"",n=void 0!==c('[id$="glavVar2"]').val()?c('[id$="glavVar2"]').val():"",r=void 0!==c('[id$="glavVar3"]').val()?c('[id$="glavVar3"]').val():"",i=void 0!==c('[id$="glavVar4"]').val()?c('[id$="glavVar4"]').val():"";Visualforce.remoting.Manager.invokeAction(s.getUnassociatedRecordsAction,e,t,a,s.bankAccountId,o,n,r,i,4e3,u,s.bankLedgerId,function(e,t){t.status?(void 0!==e&&0<e.length?(function(e){void 0!==d&&d.clear(),d=c("#unassociatedTable").DataTable({data:e,lengthMenu:[[10,25,50,100,500],[10,25,50,100,500]],pageLength:100,columns:[{title:'<input id="unassociatedCheckboxHeader" type="checkbox"/>',data:"selected"},{title:"Name",data:"sourceObj"},{title:"Customer Name",data:"customerName"},{title:"Record Date",data:"objDate"},{title:"Amount",data:"money"},{title:"Ledger Amount",data:"money"},{title:"Reference",data:"reference"},{title:"Source",data:"sourceObj"}],columnDefs:[{searchable:!1,orderable:!1,targets:0,render:function(e,t,a,o){return'<input class="unassociatedCheckbox" onchange="AcctSeed.ASModule.checkSelectedUnassociateLimit()" type="checkbox"/>'}},{targets:1,render:function(e,t,a,o){return'<a target="_blank" href="'+e.baseURL+"/"+e.sourceId+'">'+e.sourceName+"</a>"}},{targets:4,createdCell:function(e,t,a,o,n){t.recordAmount<0&&c(e).addClass("negativeAmount")},render:function(e,t,a,o){return"sort"===t||"type"===t?e.recordAmount:l(e.recordAmount,2,!1,e.recordCurrency)},className:"align-right"},{targets:5,visible:g,createdCell:function(e,t,a,o,n){t.ledgerAmount<0&&c(e).addClass("negativeAmount")},render:function(e,t,a,o){return"sort"===t||"type"===t?e.ledgerAmount:l(e.ledgerAmount,2,!1,e.ledgerCurrency)},className:"align-right"},{targets:6,orderable:!1,visible:!0},{targets:7,render:function(e,t,a,o){return'<a target="_blank" href="'+e.baseURL+"/"+e.sourceId+'">'+e.sourceType+"</a>"}}],order:[[3,"asc"]]}),c("#unassociatedCheckboxHeader").on("change",function(){s.selectOrDeselectAll(this.id,"unassociatedCheckbox"),s.checkSelectedUnassociateLimit()}),c(".unassociatedCheckbox").each(function(){c(this).on("change",function(){s.setSelectAllUnchecked("unassociatedCheckboxHeader")})})}(e),h?c('[id$="errorPanel"]').show():c('[id$="errorPanel"]').hide(),c('[id$="zeroSearchResultMessage"]').hide(),c('[id$="associateButton"]').show(),h=!1):(c('[id$="zeroSearchResultMessage"]').show(),c('[id$="associateButton"]').hide()),void 0!==e&&4e3<=e.length&&c('[id$="lineLimitError"]').show()):(t.type,c('[id$="errorPanel"]').show(),c('[id$="errorPanel"]').find("h4").html("Error: "+t.message),c('[id$="dataTablePanel"]').hide());s.showOrHideDataPanel(!0)},{escape:!1,timeout:12e4})},s.checkSelectedUnassociateLimit=function(){1e3<e(d,".unassociatedCheckbox")?(c('[id$="selectUnassociatedLimitError"]').show(),c('[id$=":associateButton"]').hide()):(c('[id$="selectUnassociatedLimitError"]').hide(),c('[id$=":associateButton"]').show())},s.associateSelectedLines=function(){var t,n=[],e=void 0!==i?i.data().length:0;d.rows().every(function(e,t,a){var o=this.data();c(c(this.node()).find(".unassociatedCheckbox")).prop("checked")&&(o.selected=!0,n.push(v(o)))}),4e3<e+n.length?(c('[id$="overSizeUnassociated"]').show(),A(),$()):0<n.length?(t=[],r(n,500).forEach(function(e){t.push(e)}),a(t[0],!0).then(function(){return 1<t.length?a(t[1],!0):Promise.resolve()}).then(o).then(function(e){$(),f(e),c('[id$=":associationCompleteMessage"]').show()}).catch(function(e){h=!0,$(),c('[id$="errorPanel"]').show(),c('[id$="errorPanel"]').find("h4").html("Error: "+e.message)})):(A(),$())},function(e){t=l(e.recordAmount,2,!1),n=l(e.ledgerAmount,2,!1,e.ledgerCurrency),c('[id$="totalAmount"]').text(t),c('[id$="totalLedgerAmount"]').text(n),b(c('[id$="totalAmount"]')),b(c('[id$="totalLedgerAmount"]'))}),b=function(e){s.numberParserByLocale(c(e).text())<0?c(e).addClass("negativeAmount"):c(e).removeClass("negativeAmount")},A=function(){c('[id$="totalAmount"]').text(t),c('[id$="totalLedgerAmount"]').text(n)},v=(s.disableButtonsSpecialForBankManagerPage=function(e){c('[id$="thePanel"] .pbButton > .btn, [id$="thePanel"] .pbButtonb > .btn').toggleClass("btnDisabled").prop("disabled",!0).val(e)},s.checkSelectedAssociateLimit=function(){1e3<e(i,".associatedCheckbox")?(c('[id$="selectAssociatedLimitError"]').show(),c('[id$=":unAssociateButton"]').hide()):(c('[id$="selectAssociatedLimitError"]').hide(),c('[id$=":unAssociateButton"]').show())},s.unassociateSelectedLines=function(){var t,n=[];i.rows().every(function(e,t,a){var o=this.data();c(c(this.node()).find(".associatedCheckbox")).prop("checked")&&(o.selected=!0,n.push(v(o)))}),0<n.length?(t=[],r(n,500).forEach(function(e){t.push(e)}),a(t[0],!1).then(function(){return 1<t.length?a(t[1],!1):Promise.resolve()}).then(o).then(function(e){$(),f(e),c('[id$="unassociationCompleteMessage"]').show()}).catch(function(e){c('[id$="errorPanel"]').show(),c('[id$="errorPanel"]').find("h4").html("Error: "+event.message)})):(A(),$())},s.showOrHideDataPanel=function(e){e?(c('[id$="loadingImage"]').hide(),c('[id$="thePanel"]').show()):(c('[id$="loadingImage"]').show(),c('[id$="thePanel"]').hide())},function(t){return["Account__c","Account__r","Amount__c","Journal_Entry__c","Payee__c","Payment_Reference__c","Name","Payment_Reference__c","Reference__c","Credit__c","Debit__c","Date__c","Ledger_Amount__c","Receipt_Date__c"].forEach(function(e){t.obj.hasOwnProperty(m+e)&&delete t.obj[m+e]}),t.name="",t.money={},t.customerName="",t.sourceObj={},t.reference="",t.objDate="",t}),e=function(e,n){var r=0;return e.rows().every(function(e,t,a){var o=c(this.node()).find(n);c(o).prop("checked")&&r++}),r},$=function(){s.getAssociatedRecords(),s.getUnassociatedRecords()};return c(function(){0!==c('[id$="dataTablePanel"]').length&&(c.fn.dataTable.moment("DD/MM/YYYY",s.defaultLocale),$()),b(c('[id$="totalAmount"]')),b(c('[id$="totalLedgerAmount"]'))}),s}((window,document,$j),AcctSeed.ASModule);